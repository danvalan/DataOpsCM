name: Create new branch

on:
  workflow_dispatch:
    inputs:
      branchName:
        description: 'Branch name'
        required: true
        type: string
      projectName:
        description: 'Project name'
        required: true
        type: string
        default: 'DEV branch of project ...'
      addUserWithEmail:
        description: 'Add user with email'
        required: false
        type: string

jobs:
  createBranch:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Create temp dir
        run: | 
            mkdir temp
            chmod 777 temp
      - name: Create temp dir, create create project script with orgId
        if: "! ${{vars.CM_ORGANIZATION_ID}}"
        run: | 
            cd temp
            echo -e "login\ncreateProject --title ${INPUT_PROJECTNAME}\ndumpProject --skipData" > createProjectScript.txt
            cat createProjectScript.txt
      - name: Create temp dir, create create project script without orgId
        if: ${{vars.CM_ORGANIZATION_ID}}
        run: | 
            cd temp
            echo -e "login\ncreateProject --title ${INPUT_PROJECTNAME} --organizationId ${vars.CM_ORGANIZATION_ID}\ndumpProject --skipData" > createProjectScript.txt
            cat createProjectScript.txt
